(this["webpackJsonpcovid-totals-app"]=this["webpackJsonpcovid-totals-app"]||[]).push([[0],{43:function(e,t,a){e.exports=a(73)},49:function(e,t,a){},73:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(13),s=a.n(l),o=(a(48),a(49),a(34)),c=a(35),u=a(42),i=a(41),m=a(10),d=a.n(m),g=a(12),h=a(18),p=a(37),E=a(36),f=a.n(E),v=a(22);var b=function(e){return console.log(e),r.a.createElement(v.a,null,r.a.createElement(v.a.Brand,{style:{flex:1}},r.a.createElement("h3",null,r.a.createElement("strong",null,"Precision19")),r.a.createElement("h5",null,"Welcome, ",e.username)),r.a.createElement(p.a,null,r.a.createElement(h.a,{className:"mr-2"},r.a.createElement(f.a,{table:"table",filename:"data_export_".concat(e.username),buttonText:"Download",className:"btn btn-dark btn-sm"})),r.a.createElement(h.a,null,r.a.createElement(g.a,{variant:"danger",className:"btn-sm",onClick:function(t){t.preventDefault(),console.log("logging out"),d.a.post("/logout").then((function(t){console.log(t.data),200===t.status&&e.updateUser({loggedIn:!1,username:null})})).then(window.location.reload()).catch((function(e){console.log("Logout error")}))}},"Log Out"))))},y=a(14),N=a.n(y),w=a(16),S=a(15),k=a(8);var P=function(e){return r.a.createElement(k.a,{id:"warn",style:{display:"block"}},r.a.createElement("p",{className:"card-text",style:{color:"#ffdd00",display:e.warnDisplay?e.warnDisplay:"none"}},e.children))},I=a(38);var O=function(e){return r.a.createElement(I.a,{animation:"border",variant:"light",style:{display:e.loadingDisplay?e.loadingDisplay:"none"}})},j={runSearch:function(){var e=Object(w.a)(N.a.mark((function e(t){var a,n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/covid?date="+t);case 3:if(200===(a=e.sent).status){e.next=6;break}throw new Error("Unsuccesssful");case 6:return e.next=8,a.json();case 8:return n=e.sent,e.abrupt("return",n);case 12:e.prev=12,e.t0=e.catch(0),console.warn(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),deleteSearch:function(e){return d.a.post("/posts/delete/"+e)}};var x=function(e){var t=Object(n.useState)(["2020","08","22"]),a=Object(S.a)(t,2),l=a[0],s=a[1],o=Object(n.useState)(!1),c=Object(S.a)(o,2),u=c[0],i=c[1],m=Object(n.useState)(!1),d=Object(S.a)(m,2),h=d[0],p=d[1],E=function(e){var t=e.target,a=parseInt(t.getAttribute("data-index")),n=2===t.value.length?t.value:"0"+t.value;l[a]=n,s(l)},f=function(){var t=Object(w.a)(N.a.mark((function t(){var a;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p(!0),t.prev=1,t.next=4,j.runSearch(l.join("-"));case 4:a=t.sent,console.log(a),void 0===a?(p(!1),i(!0)):(p(!1),i(!1),e.getPosts()),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),p(!1),console.warn(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(k.a,null,r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{className:"form-control",type:"number","data-index":"1",placeholder:"Month (#)",onChange:E})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{className:"form-control",type:"number","data-index":"2",placeholder:"Day (#)",onChange:E})),r.a.createElement("div",{className:"form-group"},r.a.createElement("select",{className:"form-control",type:"number","data-index":"0",placeholder:"Year (#)",onChange:E},r.a.createElement("option",null,"2020"))),r.a.createElement(P,{warnDisplay:u},"Please use a valid date"),r.a.createElement(O,{loadingDisplay:h}),r.a.createElement(g.a,{className:"btn btn-primary btn-sm",onClick:f,id:"submit-glob-tot"},"Go")))};var D=function(){return r.a.createElement("div",null,r.a.createElement(k.a,null,r.a.createElement("p",null,r.a.createElement("h4",null,r.a.createElement("strong",null,"For precision research on COVID-19."))),r.a.createElement("p",null,"Comensurate with the scale of the catastrophy that is the COVID-19 pandemic, the volume of data generated is staggering. This is a tool for users undertaking specific, targeted research."),r.a.createElement("p",null,'By entering the month, day, and year, and clicking "Go," Johns Hopkins global data for that date will be returned in the chart to the right.'),r.a.createElement("p",null,'Download your data to an Excel file by clicking the "Download" button on the navigation bar.'),r.a.createElement("p",null,r.a.createElement("strong",null,"PLEASE NOTE:")," the first day for which Johns Hopkins has data available is Jan 22, 2020.")))},U=a(39);var C=function(e){var t,a=e.currentPosts;return a&&(console.log(a),t=a.map((function(t){var a=new Date(t.date).toISOString().substring(0,10);return r.a.createElement("tr",{key:t._id},r.a.createElement("td",null,a),r.a.createElement("td",null,t.confirmed.toLocaleString()),r.a.createElement("td",null,t.deaths.toLocaleString()),r.a.createElement("td",null,t.recovered.toLocaleString()),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-warning btn-sm",onClick:function(){return a=t._id,void j.deleteSearch(a).then(e.getPosts).catch((function(e){return console.log(e)}));var a}},"Delete")))}))),r.a.createElement("div",null,r.a.createElement(U.a,{id:"table",striped:!0,bordered:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Date"),r.a.createElement("th",null,"Global Confirmed"),r.a.createElement("th",null,"Global Deaths"),r.a.createElement("th",null,"Global Recovered"),r.a.createElement("th",null,"Remove Search"))),r.a.createElement("tbody",null,t)))};var G=function(e){return r.a.createElement("div",null,r.a.createElement(b,{username:e.username}),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement(D,null)),r.a.createElement("div",{className:"row",id:"main"},r.a.createElement("div",{className:"col-md-3"},r.a.createElement(x,{getPosts:e.getPosts})),r.a.createElement("div",{className:"col-md-9"},r.a.createElement(C,{getPosts:e.getPosts,currentPosts:e.currentPosts})))))},L=a(76);var J=function(e){var t=r.a.useState(""),a=Object(S.a)(t,2),n=a[0],l=a[1],s=Object(L.a)();return r.a.useEffect((function(){e.loggedIn&&s.push("/")}),[e.loggedIn]),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"jumbotron",style:{background:"none"}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"}),r.a.createElement("div",{className:"col-md-6"},r.a.createElement(k.a,{style:{justifyContent:"center",alignItems:"center"}},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",null,r.a.createElement("strong",null,"Precision19"))),r.a.createElement("div",{className:"card-body"},r.a.createElement("p",null,"A targeted resource for researchers")),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{className:"form-control",type:"text",placeholder:"username",onChange:function(e){return l(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement(g.a,{type:"submit",className:"btn btn-sm btn-secondary",onClick:function(){return e.loginUser(n)}},"Log In")))),r.a.createElement("div",{className:"col"}))))};var T=function(e){return r.a.createElement(J,{loginUser:e.loginUser,loggedIn:e.loggedIn,username:e.username,userid:e.userid})},_=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={loggedIn:!1,username:null,userid:null,posts:null,currentPosts:null},e.getUser=function(){d.a.get("/user").then((function(t){console.log("Get user response: "),console.log(t),t.data.user?(console.log("Get User: There is a user saved in the server session: "),console.log(t.data.user),e.setState({loggedIn:!0,username:t.data.user,userid:t.data.id,posts:t.data.posts}),e.getPosts()):(console.log("Get user: no user"),e.setState({loggedIn:!1,username:null,userid:null}))}))},e.getPosts=function(){d.a.get("/posts").then((function(t){e.setState({currentPosts:t.data})})).catch((function(e){console.log(e)}))},e.loginUser=function(t){console.log(t),fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t})}).then((function(e){return e.json()})).then((function(t){return e.setState({loggedIn:!0,username:t.username,userid:t._id})})).then(e.updateUser).then(e.getUser).then(window.location.reload()).catch((function(e){return console.log(e)}))},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.getUser()}},{key:"updateUser",value:function(e){this.setState(e)}},{key:"render",value:function(){var e,t=this.state.loggedIn;return console.log(this.state),e=t?r.a.createElement(G,{loggedIn:this.state.loggedIn,username:this.state.username,userid:this.state.userid,posts:this.state.posts,currentPosts:this.state.currentPosts,getPosts:this.getPosts,updateUser:this.updateUser}):r.a.createElement(T,{loggedIn:this.state.loggedIn,username:this.state.username,userid:this.state.userid,loginUser:this.loginUser}),r.a.createElement("div",null,e)}}]),a}(n.Component);s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(_,null)),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.e251a816.chunk.js.map